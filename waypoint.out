project = "KubeCon Demo"

app "config" {
  
  config {
    env = {
      THEME = configdynamic("kubernetes", {
        name = "theme"
        key = "tone"
      })
    }
  }


  build {
    use "docker" {
        dockerfile = templatefile("${path.app}/Dockerfile.tpl", {
            theme = "dark"
        })
    }
    registry {
        use "docker" {
          image = "codydearkland/wpmini"
          tag = gitrefpretty()
        }
    }
 }

  deploy { 
    use "kubernetes" {
      service_port=80
    }
  }

  release {
    use "kubernetes" {
      load_balancer=true
      port=80
    }
  }
}
